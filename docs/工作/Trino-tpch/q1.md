# Q1.sql

---

```sql
SELECT
  l.returnflag,
  l.linestatus,
  sum(l.quantity)                                       AS sum_qty,
  sum(l.extendedprice)                                  AS sum_base_price,
  sum(l.extendedprice * (1 - l.discount))               AS sum_disc_price,
  sum(l.extendedprice * (1 - l.discount) * (1 + l.tax)) AS sum_charge,
  avg(l.quantity)                                       AS avg_qty,
  avg(l.extendedprice)                                  AS avg_price,
  avg(l.discount)                                       AS avg_disc,
  count(*)                                              AS count_order
FROM
  lineitem AS l
WHERE
  l.shipdate <= DATE '1998-12-01' - INTERVAL '90' DAY
GROUP BY
  l.returnflag,
  l.linestatus
ORDER BY
  l.returnflag,
  l.linestatus
;
```

## 执行计划

### Stage0

```json
{
    "session":Object{...},
    "extraCredentials":{

    },
    "fragment":{
        "id":"0",
        "root":{
            "@type":"output",
            "id":"13",
            "source":{
                "@type":"remoteSource",
                "id":"307",
                "sourceFragmentIds":[
                    "1"
                ],
                "outputs":[
                    "returnflag",
                    "linestatus",
                    "sum",
                    "sum_1",
                    "sum_2",
                    "sum_3",
                    "avg",
                    "avg_4",
                    "avg_5",
                    "count"
                ],
                "orderingScheme":{
                    "orderBy":[
                        "returnflag",
                        "linestatus"
                    ],
                    "orderings":{
                        "returnflag":"ASC_NULLS_LAST",
                        "linestatus":"ASC_NULLS_LAST"
                    }
                },
                "exchangeType":"GATHER",
                "retryPolicy":"NONE"
            },
            "columns":[
                "returnflag",
                "linestatus",
                "sum_qty",
                "sum_base_price",
                "sum_disc_price",
                "sum_charge",
                "avg_qty",
                "avg_price",
                "avg_disc",
                "count_order"
            ],
            "outputs":[
                "returnflag",
                "linestatus",
                "sum",
                "sum_1",
                "sum_2",
                "sum_3",
                "avg",
                "avg_4",
                "avg_5",
                "count"
            ]
        },
        "symbols":{
            "avg_5":"double",
            "avg_4":"double",
            "sum":"double",
            "avg":"double",
            "linestatus":"varchar(1)",
            "returnflag":"varchar(1)",
            "count":"bigint",
            "sum_3":"double",
            "sum_2":"double",
            "sum_1":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SINGLE",
                "function":"SINGLE"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"SINGLE",
                        "function":"SINGLE"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "returnflag",
                "linestatus",
                "sum",
                "sum_1",
                "sum_2",
                "sum_3",
                "avg",
                "avg_4",
                "avg_5",
                "count"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage1

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"1",
        "root":{
            "@type":"exchange",
            "id":"376",
            "type":"GATHER",
            "scope":"LOCAL",
            "partitioningScheme":{
                "partitioning":{
                    "handle":{
                        "connectorHandle":{
                            "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                            "partitioning":"FIXED",
                            "function":"UNKNOWN"
                        },
                        "scaleWriters":false
                    },
                    "arguments":[

                    ]
                },
                "outputLayout":[
                    "returnflag",
                    "linestatus",
                    "sum",
                    "sum_1",
                    "sum_2",
                    "sum_3",
                    "avg",
                    "avg_4",
                    "avg_5",
                    "count"
                ],
                "replicateNullsAndAny":false
            },
            "sources":[
                {
                    "@type":"sort",
                    "id":"308",
                    "source":{
                        "@type":"remoteSource",
                        "id":"306",
                        "sourceFragmentIds":[
                            "2"
                        ],
                        "outputs":[
                            "returnflag",
                            "linestatus",
                            "sum",
                            "sum_1",
                            "sum_2",
                            "sum_3",
                            "avg",
                            "avg_4",
                            "avg_5",
                            "count"
                        ],
                        "exchangeType":"REPARTITION",
                        "retryPolicy":"NONE"
                    },
                    "orderingScheme":{
                        "orderBy":[
                            "returnflag",
                            "linestatus"
                        ],
                        "orderings":{
                            "returnflag":"ASC_NULLS_LAST",
                            "linestatus":"ASC_NULLS_LAST"
                        }
                    },
                    "partial":true
                }
            ],
            "inputs":[
                [
                    "returnflag",
                    "linestatus",
                    "sum",
                    "sum_1",
                    "sum_2",
                    "sum_3",
                    "avg",
                    "avg_4",
                    "avg_5",
                    "count"
                ]
            ],
            "orderingScheme":{
                "orderBy":[
                    "returnflag",
                    "linestatus"
                ],
                "orderings":{
                    "returnflag":"ASC_NULLS_LAST",
                    "linestatus":"ASC_NULLS_LAST"
                }
            }
        },
        "symbols":{
            "avg_5":"double",
            "avg_4":"double",
            "sum":"double",
            "avg":"double",
            "linestatus":"varchar(1)",
            "returnflag":"varchar(1)",
            "count":"bigint",
            "sum_3":"double",
            "sum_2":"double",
            "sum_1":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"FIXED",
                "function":"ROUND_ROBIN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"SINGLE",
                        "function":"SINGLE"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "returnflag",
                "linestatus",
                "sum",
                "sum_1",
                "sum_2",
                "sum_3",
                "avg",
                "avg_4",
                "avg_5",
                "count"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage2

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"2",
        "root":{
            "@type":"project",
            "id":"438",
            "source":{
                "@type":"aggregation",
                "id":"5",
                "source":{
                    "@type":"exchange",
                    "id":"402",
                    "type":"REPARTITION",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"FIXED",
                                    "function":"HASH"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[
                                {
                                    "expression":"\"returnflag\""
                                },
                                {
                                    "expression":"\"linestatus\""
                                }
                            ]
                        },
                        "outputLayout":[
                            "returnflag",
                            "linestatus",
                            "count_13",
                            "sum_7",
                            "avg_11",
                            "sum_6",
                            "avg_10",
                            "avg_12",
                            "sum_9",
                            "sum_8",
                            "$hashvalue"
                        ],
                        "hashColumn":"$hashvalue",
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"408",
                            "sourceFragmentIds":[
                                "3"
                            ],
                            "outputs":[
                                "returnflag",
                                "linestatus",
                                "count_13",
                                "sum_7",
                                "avg_11",
                                "sum_6",
                                "avg_10",
                                "avg_12",
                                "sum_9",
                                "sum_8",
                                "$hashvalue_14"
                            ],
                            "exchangeType":"REPARTITION",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "returnflag",
                            "linestatus",
                            "count_13",
                            "sum_7",
                            "avg_11",
                            "sum_6",
                            "avg_10",
                            "avg_12",
                            "sum_9",
                            "sum_8",
                            "$hashvalue_14"
                        ]
                    ]
                },
                "aggregations":{
                    "avg":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"avg",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"avg(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"avg_10\""
                        ],
                        "distinct":false
                    },
                    "sum_3":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"sum",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"sum(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"sum_9\""
                        ],
                        "distinct":false
                    },
                    "sum_2":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"sum",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"sum(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"sum_8\""
                        ],
                        "distinct":false
                    },
                    "sum_1":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"sum",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"sum(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"sum_7\""
                        ],
                        "distinct":false
                    },
                    "avg_5":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"avg",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"avg(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"avg_12\""
                        ],
                        "distinct":false
                    },
                    "count":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"count",
                                "returnType":"bigint",
                                "argumentTypes":[

                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"count():bigint",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[

                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"count_13\""
                        ],
                        "distinct":false
                    },
                    "avg_4":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"avg",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"avg(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"avg_11\""
                        ],
                        "distinct":false
                    },
                    "sum":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"sum",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"sum(double):double",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{

                            },
                            "functionDependencies":[

                            ]
                        },
                        "arguments":[
                            "\"sum_6\""
                        ],
                        "distinct":false
                    }
                },
                "groupingSets":{
                    "groupingKeys":[
                        "returnflag",
                        "linestatus"
                    ],
                    "groupingSetCount":1,
                    "globalGroupingSets":[

                    ]
                },
                "preGroupedSymbols":[

                ],
                "step":"FINAL",
                "hashSymbol":"$hashvalue"
            },
            "assignments":{
                "assignments":{
                    "returnflag":"\"returnflag\"",
                    "linestatus":"\"linestatus\"",
                    "avg":"\"avg\"",
                    "sum_3":"\"sum_3\"",
                    "sum_2":"\"sum_2\"",
                    "sum_1":"\"sum_1\"",
                    "avg_5":"\"avg_5\"",
                    "count":"\"count\"",
                    "avg_4":"\"avg_4\"",
                    "sum":"\"sum\""
                }
            }
        },
        "symbols":{
            "count_13":"bigint",
            "avg_5":"double",
            "sum_7":"row(bigint,boolean,double,boolean)",
            "avg_4":"double",
            "sum_6":"row(bigint,boolean,double,boolean)",
            "sum":"double",
            "sum_9":"row(bigint,boolean,double,boolean)",
            "sum_8":"row(bigint,boolean,double,boolean)",
            "avg":"double",
            "linestatus":"varchar(1)",
            "avg_11":"row(double,bigint)",
            "avg_10":"row(double,bigint)",
            "avg_12":"row(double,bigint)",
            "$hashvalue_14":"bigint",
            "returnflag":"varchar(1)",
            "count":"bigint",
            "sum_3":"double",
            "sum_2":"double",
            "sum_1":"double",
            "$hashvalue":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"FIXED",
                "function":"HASH"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"ROUND_ROBIN"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "returnflag",
                "linestatus",
                "sum",
                "sum_1",
                "sum_2",
                "sum_3",
                "avg",
                "avg_4",
                "avg_5",
                "count"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage3

```json
{
    "session":Object{...},
    "extraCredentials":{

    },
    "fragment":{
        "id":"3",
        "root":{
            "@type":"aggregation",
            "id":"406",
            "source":{
                "@type":"project",
                "id":"56",
                "source":{
                    "@type":"filter",
                    "id":"1",
                    "source":{
                        "@type":"tablescan",
                        "id":"0",
                        "table":{
                            "catalogHandle":"tpch:normal:default",
                            "connectorHandle":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                "schemaName":"sf1",
                                "tableName":"lineitem",
                                "scaleFactor":1,
                                "constraint":{
                                    "columnDomains":[

                                    ]
                                }
                            },
                            "transaction":[
                                "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                "INSTANCE"
                            ]
                        },
                        "outputSymbols":[
                            "quantity",
                            "extendedprice",
                            "discount",
                            "tax",
                            "returnflag",
                            "linestatus",
                            "shipdate"
                        ],
                        "assignments":{
                            "returnflag":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"returnflag",
                                "type":"varchar(1)"
                            },
                            "quantity":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"quantity",
                                "type":"double"
                            },
                            "linestatus":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"linestatus",
                                "type":"varchar(1)"
                            },
                            "extendedprice":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"extendedprice",
                                "type":"double"
                            },
                            "discount":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"discount",
                                "type":"double"
                            },
                            "tax":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"tax",
                                "type":"double"
                            },
                            "shipdate":{
                                "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                "columnName":"shipdate",
                                "type":"date"
                            }
                        },
                        "updateTarget":false,
                        "useConnectorNodePartitioning":true
                    },
                    "predicate":"(\"shipdate\" <= DATE '1998-09-02')"
                },
                "assignments":{
                    "assignments":{
                        "quantity":"\"quantity\"",
                        "linestatus":"\"linestatus\"",
                        "extendedprice":"\"extendedprice\"",
                        "returnflag":"\"returnflag\"",
                        "discount":"\"discount\"",
                        "expr":"(\"extendedprice\" * (1E0 - \"discount\"))",
                        "expr_0":"((\"extendedprice\" * (1E0 - \"discount\")) * (\"tax\" + 1E0))",
                        "$hashvalue_15":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4B804Q1O04B7IU8IGH6DG0I597F4JBIF429MP4SHC31L40A7E6POLH7UG9TRDPJ6CPJO064Q7CCH4IVTPIGJA7UD44AFMG6VP30LA89PJH1RB21A1OOGBR4KGRDQBBTHDBM7CMJF6P88PD0H5O784B83DLL94G891UOG903421OFQFADK074J9TC87I631QUA2D1SEDAD9RN8NNMJICOOL2T665E58LP6HOHG03GE4F5E3GGRT5NJA7D8E5SEBATBB68AFPOJ4MK86DMTIK7IG3GIHS2M6M8OBHDN9U9KOF9T6GDT4GUHRD58PLT9E10E00UH4G1S639J1Q19HPJGFQ6RODKVEV0CC6DHA87CNI7G5RV17I4JIMUPC130236OK3T0====\"(\"returnflag\"), 0)), COALESCE(\"@$operator$HASH_CODE@52QIVVB4B804Q1O04B7IU8IGH6DG0I597F4JBIF429MP4SHC31L40A7E6POLH7UG9TRDPJ6CPJO064Q7CCH4IVTPIGJA7UD44AFMG6VP30LA89PJH1RB21A1OOGBR4KGRDQBBTHDBM7CMJF6P88PD0H5O784B83DLL94G891UOG903421OFQFADK074J9TC87I631QUA2D1SEDAD9RN8NNMJICOOL2T665E58LP6HOHG03GE4F5E3GGRT5NJA7D8E5SEBATBB68AFPOJ4MK86DMTIK7IG3GIHS2M6M8OBHDN9U9KOF9T6GDT4GUHRD58PLT9E10E00UH4G1S639J1Q19HPJGFQ6RODKVEV0CC6DHA87CNI7G5RV17I4JIMUPC130236OK3T0====\"(\"linestatus\"), 0))"
                    }
                }
            },
            "aggregations":{
                "count_13":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"count",
                            "returnType":"bigint",
                            "argumentTypes":[

                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"count():bigint",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[

                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[

                    ],
                    "distinct":false
                },
                "sum_7":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"sum",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"sum(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"extendedprice\""
                    ],
                    "distinct":false
                },
                "avg_11":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"avg",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"avg(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"extendedprice\""
                    ],
                    "distinct":false
                },
                "sum_6":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"sum",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"sum(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"quantity\""
                    ],
                    "distinct":false
                },
                "avg_10":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"avg",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"avg(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"quantity\""
                    ],
                    "distinct":false
                },
                "avg_12":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"avg",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"avg(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"discount\""
                    ],
                    "distinct":false
                },
                "sum_9":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"sum",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"sum(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"expr_0\""
                    ],
                    "distinct":false
                },
                "sum_8":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"sum",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"sum(double):double",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{

                        },
                        "functionDependencies":[

                        ]
                    },
                    "arguments":[
                        "\"expr\""
                    ],
                    "distinct":false
                }
            },
            "groupingSets":{
                "groupingKeys":[
                    "returnflag",
                    "linestatus"
                ],
                "groupingSetCount":1,
                "globalGroupingSets":[

                ]
            },
            "preGroupedSymbols":[

            ],
            "step":"PARTIAL",
            "hashSymbol":"$hashvalue_15"
        },
        "symbols":{
            "count_13":"bigint",
            "sum_7":"row(bigint,boolean,double,boolean)",
            "discount":"double",
            "sum_6":"row(bigint,boolean,double,boolean)",
            "sum_9":"row(bigint,boolean,double,boolean)",
            "expr_0":"double",
            "sum_8":"row(bigint,boolean,double,boolean)",
            "linestatus":"varchar(1)",
            "avg_11":"row(double,bigint)",
            "avg_10":"row(double,bigint)",
            "$hashvalue_15":"bigint",
            "expr":"double",
            "avg_12":"row(double,bigint)",
            "shipdate":"date",
            "returnflag":"varchar(1)",
            "quantity":"double",
            "tax":"double",
            "extendedprice":"double"
        },
        "partitioning":{
            "catalogHandle":"tpch:normal:default",
            "transactionHandle":[
                "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                "INSTANCE"
            ],
            "connectorHandle":{
                "@type":"tpch:io.trino.plugin.tpch.TpchPartitioningHandle",
                "table":"orders",
                "totalRows":1500000
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "0"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"HASH"
                    },
                    "scaleWriters":false
                },
                "arguments":[
                    {
                        "expression":"\"returnflag\""
                    },
                    {
                        "expression":"\"linestatus\""
                    }
                ]
            },
            "outputLayout":[
                "returnflag",
                "linestatus",
                "count_13",
                "sum_7",
                "avg_11",
                "sum_6",
                "avg_10",
                "avg_12",
                "sum_9",
                "sum_8",
                "$hashvalue_15"
            ],
            "hashColumn":"$hashvalue_15",
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```



