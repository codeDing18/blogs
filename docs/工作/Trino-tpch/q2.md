# Q2.sql

---

```sql
SELECT
  s.acctbal,
  s.name,
  n.name,
  p.partkey,
  p.mfgr,
  s.address,
  s.phone,
  s.comment
FROM
  part p,
  supplier s,
  partsupp ps,
  nation n,
  region r
WHERE
  p.partkey = ps.partkey
  AND s.suppkey = ps.suppkey
  AND p.size = 15
  AND p.type like '%BRASS'
  AND s.nationkey = n.nationkey
  AND n.regionkey = r.regionkey
  AND r.name = 'EUROPE'
  AND ps.supplycost = (
    SELECT
      min(ps.supplycost)
    FROM
      partsupp ps,
      supplier s,
      nation n,
      region r
    WHERE
      p.partkey = ps.partkey
      AND s.suppkey = ps.suppkey
      AND s.nationkey = n.nationkey
      AND n.regionkey = r.regionkey
      AND r.name = 'EUROPE'
  )
ORDER BY
  s.acctbal desc,
  n.name,
  s.name,
  p.partkey
;
```

## 执行计划

### Stage0

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"0",
        "root":{
            "@type":"output",
            "id":"34",
            "source":{
                "@type":"remoteSource",
                "id":"1949",
                "sourceFragmentIds":[
                    "1"
                ],
                "outputs":[
                    "partkey_4",
                    "comment_2",
                    "name_1",
                    "address",
                    "phone",
                    "mfgr",
                    "name_9",
                    "acctbal"
                ],
                "orderingScheme":{
                    "orderBy":[
                        "acctbal",
                        "name_9",
                        "name_1",
                        "partkey_4"
                    ],
                    "orderings":{
                        "acctbal":"DESC_NULLS_LAST",
                        "name_9":"ASC_NULLS_LAST",
                        "name_1":"ASC_NULLS_LAST",
                        "partkey_4":"ASC_NULLS_LAST"
                    }
                },
                "exchangeType":"GATHER",
                "retryPolicy":"NONE"
            },
            "columns":[
                "acctbal",
                "name",
                "name",
                "partkey",
                "mfgr",
                "address",
                "phone",
                "comment"
            ],
            "outputs":[
                "acctbal",
                "name_1",
                "name_9",
                "partkey_4",
                "mfgr",
                "address",
                "phone",
                "comment_2"
            ]
        },
        "symbols":{
            "phone":"varchar(15)",
            "name_1":"varchar(25)",
            "address":"varchar(40)",
            "mfgr":"varchar(25)",
            "partkey_4":"bigint",
            "comment_2":"varchar(101)",
            "name_9":"varchar(25)",
            "acctbal":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SINGLE",
                "function":"SINGLE"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"SINGLE",
                        "function":"SINGLE"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "acctbal",
                "name_1",
                "name_9",
                "partkey_4",
                "mfgr",
                "address",
                "phone",
                "comment_2"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage1

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"1",
        "root":{
            "@type":"exchange",
            "id":"2468",
            "type":"GATHER",
            "scope":"LOCAL",
            "partitioningScheme":{
                "partitioning":{
                    "handle":{
                        "connectorHandle":{
                            "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                            "partitioning":"FIXED",
                            "function":"UNKNOWN"
                        },
                        "scaleWriters":false
                    },
                    "arguments":[

                    ]
                },
                "outputLayout":[
                    "partkey_4",
                    "comment_2",
                    "name_1",
                    "address",
                    "phone",
                    "mfgr",
                    "name_9",
                    "acctbal"
                ],
                "replicateNullsAndAny":false
            },
            "sources":[
                {
                    "@type":"sort",
                    "id":"1950",
                    "source":{
                        "@type":"remoteSource",
                        "id":"1948",
                        "sourceFragmentIds":[
                            "2"
                        ],
                        "outputs":[
                            "partkey_4",
                            "comment_2",
                            "name_1",
                            "address",
                            "phone",
                            "mfgr",
                            "name_9",
                            "acctbal"
                        ],
                        "exchangeType":"REPARTITION",
                        "retryPolicy":"NONE"
                    },
                    "orderingScheme":{
                        "orderBy":[
                            "acctbal",
                            "name_9",
                            "name_1",
                            "partkey_4"
                        ],
                        "orderings":{
                            "acctbal":"DESC_NULLS_LAST",
                            "name_9":"ASC_NULLS_LAST",
                            "name_1":"ASC_NULLS_LAST",
                            "partkey_4":"ASC_NULLS_LAST"
                        }
                    },
                    "partial":true
                }
            ],
            "inputs":[
                [
                    "partkey_4",
                    "comment_2",
                    "name_1",
                    "address",
                    "phone",
                    "mfgr",
                    "name_9",
                    "acctbal"
                ]
            ],
            "orderingScheme":{
                "orderBy":[
                    "acctbal",
                    "name_9",
                    "name_1",
                    "partkey_4"
                ],
                "orderings":{
                    "acctbal":"DESC_NULLS_LAST",
                    "name_9":"ASC_NULLS_LAST",
                    "name_1":"ASC_NULLS_LAST",
                    "partkey_4":"ASC_NULLS_LAST"
                }
            }
        },
        "symbols":{
            "phone":"varchar(15)",
            "name_1":"varchar(25)",
            "address":"varchar(40)",
            "mfgr":"varchar(25)",
            "partkey_4":"bigint",
            "comment_2":"varchar(101)",
            "name_9":"varchar(25)",
            "acctbal":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"FIXED",
                "function":"ROUND_ROBIN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"SINGLE",
                        "function":"SINGLE"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "partkey_4",
                "comment_2",
                "name_1",
                "address",
                "phone",
                "mfgr",
                "name_9",
                "acctbal"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage2

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"2",
        "root":{
            "@type":"project",
            "id":"734",
            "source":{
                "@type":"filter",
                "id":"2169",
                "source":{
                    "@type":"join",
                    "id":"996",
                    "type":"INNER",
                    "left":{
                        "@type":"join",
                        "id":"493",
                        "type":"LEFT",
                        "left":{
                            "@type":"project",
                            "id":"2745",
                            "source":{
                                "@type":"join",
                                "id":"1706",
                                "type":"INNER",
                                "left":{
                                    "@type":"project",
                                    "id":"2740",
                                    "source":{
                                        "@type":"join",
                                        "id":"1705",
                                        "type":"INNER",
                                        "left":{
                                            "@type":"project",
                                            "id":"2739",
                                            "source":{
                                                "@type":"filter",
                                                "id":"2129",
                                                "source":{
                                                    "@type":"tablescan",
                                                    "id":"3",
                                                    "table":{
                                                        "catalogHandle":"tpch:normal:default",
                                                        "connectorHandle":{
                                                            "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                                            "schemaName":"sf1",
                                                            "tableName":"partsupp",
                                                            "scaleFactor":1,
                                                            "constraint":{
                                                                "columnDomains":[

                                                                ]
                                                            }
                                                        },
                                                        "transaction":[
                                                            "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                                            "INSTANCE"
                                                        ]
                                                    },
                                                    "outputSymbols":[
                                                        "partkey_4",
                                                        "suppkey_5",
                                                        "supplycost"
                                                    ],
                                                    "assignments":{
                                                        "suppkey_5":{
                                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                                            "columnName":"suppkey",
                                                            "type":"bigint"
                                                        },
                                                        "supplycost":{
                                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                                            "columnName":"supplycost",
                                                            "type":"double"
                                                        },
                                                        "partkey_4":{
                                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                                            "columnName":"partkey",
                                                            "type":"bigint"
                                                        }
                                                    },
                                                    "updateTarget":false,
                                                    "useConnectorNodePartitioning":false
                                                },
                                                "predicate":"(\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"suppkey_5\", 'EQUAL', 'df_2127', false) AND \"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"partkey_4\", 'EQUAL', 'df_2128', false))"
                                            },
                                            "assignments":{
                                                "assignments":{
                                                    "partkey_4":"\"partkey_4\"",
                                                    "suppkey_5":"\"suppkey_5\"",
                                                    "supplycost":"\"supplycost\"",
                                                    "$hashvalue":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"partkey_4\"), 0))"
                                                }
                                            }
                                        },
                                        "right":{
                                            "@type":"exchange",
                                            "id":"2458",
                                            "type":"GATHER",
                                            "scope":"LOCAL",
                                            "partitioningScheme":{
                                                "partitioning":{
                                                    "handle":{
                                                        "connectorHandle":{
                                                            "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                                            "partitioning":"SINGLE",
                                                            "function":"SINGLE"
                                                        },
                                                        "scaleWriters":false
                                                    },
                                                    "arguments":[

                                                    ]
                                                },
                                                "outputLayout":[
                                                    "partkey",
                                                    "mfgr",
                                                    "$hashvalue_42"
                                                ],
                                                "replicateNullsAndAny":false
                                            },
                                            "sources":[
                                                {
                                                    "@type":"remoteSource",
                                                    "id":"1938",
                                                    "sourceFragmentIds":[
                                                        "3"
                                                    ],
                                                    "outputs":[
                                                        "partkey",
                                                        "mfgr",
                                                        "$hashvalue_43"
                                                    ],
                                                    "exchangeType":"REPLICATE",
                                                    "retryPolicy":"NONE"
                                                }
                                            ],
                                            "inputs":[
                                                [
                                                    "partkey",
                                                    "mfgr",
                                                    "$hashvalue_43"
                                                ]
                                            ]
                                        },
                                        "criteria":[
                                            {
                                                "left":"partkey_4",
                                                "right":"partkey"
                                            }
                                        ],
                                        "leftOutputSymbols":[
                                            "partkey_4",
                                            "suppkey_5",
                                            "supplycost"
                                        ],
                                        "rightOutputSymbols":[
                                            "mfgr"
                                        ],
                                        "maySkipOutputDuplicates":false,
                                        "leftHashSymbol":"$hashvalue",
                                        "rightHashSymbol":"$hashvalue_42",
                                        "distributionType":"REPLICATED",
                                        "dynamicFilters":{
                                            "df_2128":"partkey"
                                        },
                                        "reorderJoinStatsAndCost":{
                                            "outputRowCount":14400.000000000002,
                                            "outputSizeInBytes":460805.04000000004,
                                            "cpuCost":53418328.82,
                                            "memoryCost":50401.26,
                                            "networkCost":50401.26
                                        }
                                    },
                                    "assignments":{
                                        "assignments":{
                                            "partkey_4":"\"partkey_4\"",
                                            "suppkey_5":"\"suppkey_5\"",
                                            "supplycost":"\"supplycost\"",
                                            "mfgr":"\"mfgr\"",
                                            "$hashvalue_45":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"suppkey_5\"), 0))"
                                        }
                                    }
                                },
                                "right":{
                                    "@type":"exchange",
                                    "id":"2461",
                                    "type":"REPARTITION",
                                    "scope":"LOCAL",
                                    "partitioningScheme":{
                                        "partitioning":{
                                            "handle":{
                                                "connectorHandle":{
                                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                                    "partitioning":"FIXED",
                                                    "function":"HASH"
                                                },
                                                "scaleWriters":false
                                            },
                                            "arguments":[
                                                {
                                                    "expression":"\"suppkey\""
                                                }
                                            ]
                                        },
                                        "outputLayout":[
                                            "suppkey",
                                            "name_1",
                                            "address",
                                            "phone",
                                            "acctbal",
                                            "comment_2",
                                            "name_9",
                                            "$hashvalue_46"
                                        ],
                                        "hashColumn":"$hashvalue_46",
                                        "replicateNullsAndAny":false
                                    },
                                    "sources":[
                                        {
                                            "@type":"remoteSource",
                                            "id":"1941",
                                            "sourceFragmentIds":[
                                                "4"
                                            ],
                                            "outputs":[
                                                "suppkey",
                                                "name_1",
                                                "address",
                                                "phone",
                                                "acctbal",
                                                "comment_2",
                                                "name_9",
                                                "$hashvalue_47"
                                            ],
                                            "exchangeType":"REPLICATE",
                                            "retryPolicy":"NONE"
                                        }
                                    ],
                                    "inputs":[
                                        [
                                            "suppkey",
                                            "name_1",
                                            "address",
                                            "phone",
                                            "acctbal",
                                            "comment_2",
                                            "name_9",
                                            "$hashvalue_47"
                                        ]
                                    ]
                                },
                                "criteria":[
                                    {
                                        "left":"suppkey_5",
                                        "right":"suppkey"
                                    }
                                ],
                                "leftOutputSymbols":[
                                    "partkey_4",
                                    "supplycost",
                                    "mfgr"
                                ],
                                "rightOutputSymbols":[
                                    "name_1",
                                    "address",
                                    "phone",
                                    "acctbal",
                                    "comment_2",
                                    "name_9"
                                ],
                                "maySkipOutputDuplicates":false,
                                "leftHashSymbol":"$hashvalue_45",
                                "rightHashSymbol":"$hashvalue_46",
                                "distributionType":"REPLICATED",
                                "dynamicFilters":{
                                    "df_2127":"suppkey"
                                },
                                "reorderJoinStatsAndCost":{
                                    "outputRowCount":2880.0000000000005,
                                    "outputSizeInBytes":531725.616,
                                    "cpuCost":58787606.276,
                                    "memoryCost":391759.86,
                                    "networkCost":391768.86
                                }
                            },
                            "assignments":{
                                "assignments":{
                                    "partkey_4":"\"partkey_4\"",
                                    "supplycost":"\"supplycost\"",
                                    "mfgr":"\"mfgr\"",
                                    "name_1":"\"name_1\"",
                                    "address":"\"address\"",
                                    "phone":"\"phone\"",
                                    "acctbal":"\"acctbal\"",
                                    "comment_2":"\"comment_2\"",
                                    "name_9":"\"name_9\"",
                                    "$hashvalue_57":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"partkey_4\"), 0))"
                                }
                            }
                        },
                        "right":{
                            "@type":"exchange",
                            "id":"2466",
                            "type":"REPARTITION",
                            "scope":"LOCAL",
                            "partitioningScheme":{
                                "partitioning":{
                                    "handle":{
                                        "connectorHandle":{
                                            "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                            "partitioning":"FIXED",
                                            "function":"HASH"
                                        },
                                        "scaleWriters":false
                                    },
                                    "arguments":[
                                        {
                                            "expression":"\"partkey_16\""
                                        }
                                    ]
                                },
                                "outputLayout":[
                                    "partkey_16",
                                    "min",
                                    "$hashvalue_58"
                                ],
                                "hashColumn":"$hashvalue_58",
                                "replicateNullsAndAny":false
                            },
                            "sources":[
                                {
                                    "@type":"remoteSource",
                                    "id":"1946",
                                    "sourceFragmentIds":[
                                        "7"
                                    ],
                                    "outputs":[
                                        "partkey_16",
                                        "min",
                                        "$hashvalue_59"
                                    ],
                                    "exchangeType":"REPLICATE",
                                    "retryPolicy":"NONE"
                                }
                            ],
                            "inputs":[
                                [
                                    "partkey_16",
                                    "min",
                                    "$hashvalue_59"
                                ]
                            ]
                        },
                        "criteria":[
                            {
                                "left":"partkey_4",
                                "right":"partkey_16"
                            }
                        ],
                        "leftOutputSymbols":[
                            "partkey_4",
                            "supplycost",
                            "mfgr",
                            "name_1",
                            "address",
                            "phone",
                            "acctbal",
                            "comment_2",
                            "name_9"
                        ],
                        "rightOutputSymbols":[
                            "min"
                        ],
                        "maySkipOutputDuplicates":false,
                        "leftHashSymbol":"$hashvalue_57",
                        "rightHashSymbol":"$hashvalue_58",
                        "distributionType":"REPLICATED",
                        "dynamicFilters":{

                        }
                    },
                    "right":{
                        "@type":"exchange",
                        "id":"2467",
                        "type":"GATHER",
                        "scope":"LOCAL",
                        "partitioningScheme":{
                            "partitioning":{
                                "handle":{
                                    "connectorHandle":{
                                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                        "partitioning":"SINGLE",
                                        "function":"SINGLE"
                                    },
                                    "scaleWriters":false
                                },
                                "arguments":[

                                ]
                            },
                            "outputLayout":[
                                "min_40"
                            ],
                            "replicateNullsAndAny":false
                        },
                        "sources":[
                            {
                                "@type":"remoteSource",
                                "id":"1947",
                                "sourceFragmentIds":[
                                    "12"
                                ],
                                "outputs":[
                                    "min_40"
                                ],
                                "exchangeType":"REPLICATE",
                                "retryPolicy":"NONE"
                            }
                        ],
                        "inputs":[
                            [
                                "min_40"
                            ]
                        ]
                    },
                    "criteria":[

                    ],
                    "leftOutputSymbols":[
                        "partkey_4",
                        "mfgr",
                        "name_1",
                        "address",
                        "phone",
                        "acctbal",
                        "comment_2",
                        "supplycost",
                        "name_9",
                        "min"
                    ],
                    "rightOutputSymbols":[
                        "min_40"
                    ],
                    "maySkipOutputDuplicates":false,
                    "distributionType":"REPLICATED",
                    "dynamicFilters":{

                    }
                },
                "predicate":"(\"supplycost\" = COALESCE(\"min\", \"min_40\"))"
            },
            "assignments":{
                "assignments":{
                    "partkey_4":"\"partkey_4\"",
                    "comment_2":"\"comment_2\"",
                    "name_1":"\"name_1\"",
                    "address":"\"address\"",
                    "phone":"\"phone\"",
                    "mfgr":"\"mfgr\"",
                    "name_9":"\"name_9\"",
                    "acctbal":"\"acctbal\""
                }
            }
        },
        "symbols":{
            "suppkey_5":"bigint",
            "partkey":"bigint",
            "phone":"varchar(15)",
            "name_1":"varchar(25)",
            "suppkey":"bigint",
            "min":"double",
            "address":"varchar(40)",
            "min_40":"double",
            "mfgr":"varchar(25)",
            "$hashvalue":"bigint",
            "partkey_4":"bigint",
            "supplycost":"double",
            "$hashvalue_59":"bigint",
            "$hashvalue_58":"bigint",
            "$hashvalue_57":"bigint",
            "comment_2":"varchar(101)",
            "name_9":"varchar(25)",
            "$hashvalue_45":"bigint",
            "partkey_16":"bigint",
            "$hashvalue_47":"bigint",
            "$hashvalue_46":"bigint",
            "$hashvalue_43":"bigint",
            "$hashvalue_42":"bigint",
            "acctbal":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "3"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"ROUND_ROBIN"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "partkey_4",
                "comment_2",
                "name_1",
                "address",
                "phone",
                "mfgr",
                "name_9",
                "acctbal"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage3

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"3",
        "root":{
            "@type":"project",
            "id":"1213",
            "source":{
                "@type":"filter",
                "id":"585",
                "source":{
                    "@type":"tablescan",
                    "id":"0",
                    "table":{
                        "catalogHandle":"tpch:normal:default",
                        "connectorHandle":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                            "schemaName":"sf1",
                            "tableName":"part",
                            "scaleFactor":1,
                            "constraint":{
                                "columnDomains":[
                                    {
                                        "column":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                            "columnName":"container",
                                            "type":"varchar(10)"
                                        },
                                        "domain":{
                                            "values":{
                                                "@type":"sortable",
                                                "type":"varchar(10)",
                                                "inclusive":[
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true
                                                ],
                                                "sortedRanges":"DgAAAFZBUklBQkxFX1dJRFRIUAAAAFAAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAKAAAACgAAAAoAAAAKAAAACQAAAAkAAAAKAAAACgAAAAkAAAAJAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABwAAAAcAAAAHAAAABwAAAAYAAAAGAAAABwAAAAcAAAAGAAAABgAAAAcAAAAHAAAABwAAAAcAAAAHAAAABwAAAAgAAAAIAAAACAAAAAgAAAAHAAAABwAAAAgAAAAIAAAABwAAAAcAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAHAAAABwAAAAcAAAAHAAAABgAAAAYAAAAHAAAABwAAAAYAAAAGAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACQAAAAkAAAAJAAAACQAAAAgAAAAIAAAACQAAAAkAAAAIAAAACAAAAABeAgAASlVNQk8gQkFHSlVNQk8gQkFHSlVNQk8gQk9YSlVNQk8gQk9YSlVNQk8gQ0FOSlVNQk8gQ0FOSlVNQk8gQ0FTRUpVTUJPIENBU0VKVU1CTyBEUlVNSlVNQk8gRFJVTUpVTUJPIEpBUkpVTUJPIEpBUkpVTUJPIFBBQ0tKVU1CTyBQQUNLSlVNQk8gUEtHSlVNQk8gUEtHTEcgQkFHTEcgQkFHTEcgQk9YTEcgQk9YTEcgQ0FOTEcgQ0FOTEcgQ0FTRUxHIENBU0VMRyBEUlVNTEcgRFJVTUxHIEpBUkxHIEpBUkxHIFBBQ0tMRyBQQUNLTEcgUEtHTEcgUEtHTUVEIEJBR01FRCBCQUdNRUQgQk9YTUVEIEJPWE1FRCBDQU5NRUQgQ0FOTUVEIENBU0VNRUQgQ0FTRU1FRCBEUlVNTUVEIERSVU1NRUQgSkFSTUVEIEpBUk1FRCBQQUNLTUVEIFBBQ0tNRUQgUEtHTUVEIFBLR1NNIEJBR1NNIEJBR1NNIEJPWFNNIEJPWFNNIENBTlNNIENBTlNNIENBU0VTTSBDQVNFU00gRFJVTVNNIERSVU1TTSBKQVJTTSBKQVJTTSBQQUNLU00gUEFDS1NNIFBLR1NNIFBLR1dSQVAgQkFHV1JBUCBCQUdXUkFQIEJPWFdSQVAgQk9YV1JBUCBDQU5XUkFQIENBTldSQVAgQ0FTRVdSQVAgQ0FTRVdSQVAgRFJVTVdSQVAgRFJVTVdSQVAgSkFSV1JBUCBKQVJXUkFQIFBBQ0tXUkFQIFBBQ0tXUkFQIFBLR1dSQVAgUEtH"
                                            },
                                            "nullAllowed":false
                                        }
                                    },
                                    {
                                        "column":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                            "columnName":"type",
                                            "type":"varchar(25)"
                                        },
                                        "domain":{
                                            "values":{
                                                "@type":"sortable",
                                                "type":"varchar(25)",
                                                "inclusive":[
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true,
                                                    true
                                                ],
                                                "sortedRanges":"DgAAAFZBUklBQkxFX1dJRFRIPAAAADwAAAAWAAAAFgAAABUAAAAVAAAAFwAAABcAAAAUAAAAFAAAABYAAAAWAAAAFAAAABQAAAATAAAAEwAAABUAAAAVAAAAEgAAABIAAAAUAAAAFAAAABUAAAAVAAAAFAAAABQAAAAWAAAAFgAAABMAAAATAAAAFQAAABUAAAAUAAAAFAAAABMAAAATAAAAFQAAABUAAAASAAAAEgAAABQAAAAUAAAAFAAAABQAAAATAAAAEwAAABUAAAAVAAAAEgAAABIAAAAUAAAAFAAAABcAAAAXAAAAFgAAABYAAAAYAAAAGAAAABUAAAAVAAAAFwAAABcAAAAA1AQAAEVDT05PTVkgQU5PRElaRUQgQlJBU1NFQ09OT01ZIEFOT0RJWkVEIEJSQVNTRUNPTk9NWSBCUlVTSEVEIEJSQVNTRUNPTk9NWSBCUlVTSEVEIEJSQVNTRUNPTk9NWSBCVVJOSVNIRUQgQlJBU1NFQ09OT01ZIEJVUk5JU0hFRCBCUkFTU0VDT05PTVkgUExBVEVEIEJSQVNTRUNPTk9NWSBQTEFURUQgQlJBU1NFQ09OT01ZIFBPTElTSEVEIEJSQVNTRUNPTk9NWSBQT0xJU0hFRCBCUkFTU0xBUkdFIEFOT0RJWkVEIEJSQVNTTEFSR0UgQU5PRElaRUQgQlJBU1NMQVJHRSBCUlVTSEVEIEJSQVNTTEFSR0UgQlJVU0hFRCBCUkFTU0xBUkdFIEJVUk5JU0hFRCBCUkFTU0xBUkdFIEJVUk5JU0hFRCBCUkFTU0xBUkdFIFBMQVRFRCBCUkFTU0xBUkdFIFBMQVRFRCBCUkFTU0xBUkdFIFBPTElTSEVEIEJSQVNTTEFSR0UgUE9MSVNIRUQgQlJBU1NNRURJVU0gQU5PRElaRUQgQlJBU1NNRURJVU0gQU5PRElaRUQgQlJBU1NNRURJVU0gQlJVU0hFRCBCUkFTU01FRElVTSBCUlVTSEVEIEJSQVNTTUVESVVNIEJVUk5JU0hFRCBCUkFTU01FRElVTSBCVVJOSVNIRUQgQlJBU1NNRURJVU0gUExBVEVEIEJSQVNTTUVESVVNIFBMQVRFRCBCUkFTU01FRElVTSBQT0xJU0hFRCBCUkFTU01FRElVTSBQT0xJU0hFRCBCUkFTU1BST01PIEFOT0RJWkVEIEJSQVNTUFJPTU8gQU5PRElaRUQgQlJBU1NQUk9NTyBCUlVTSEVEIEJSQVNTUFJPTU8gQlJVU0hFRCBCUkFTU1BST01PIEJVUk5JU0hFRCBCUkFTU1BST01PIEJVUk5JU0hFRCBCUkFTU1BST01PIFBMQVRFRCBCUkFTU1BST01PIFBMQVRFRCBCUkFTU1BST01PIFBPTElTSEVEIEJSQVNTUFJPTU8gUE9MSVNIRUQgQlJBU1NTTUFMTCBBTk9ESVpFRCBCUkFTU1NNQUxMIEFOT0RJWkVEIEJSQVNTU01BTEwgQlJVU0hFRCBCUkFTU1NNQUxMIEJSVVNIRUQgQlJBU1NTTUFMTCBCVVJOSVNIRUQgQlJBU1NTTUFMTCBCVVJOSVNIRUQgQlJBU1NTTUFMTCBQTEFURUQgQlJBU1NTTUFMTCBQTEFURUQgQlJBU1NTTUFMTCBQT0xJU0hFRCBCUkFTU1NNQUxMIFBPTElTSEVEIEJSQVNTU1RBTkRBUkQgQU5PRElaRUQgQlJBU1NTVEFOREFSRCBBTk9ESVpFRCBCUkFTU1NUQU5EQVJEIEJSVVNIRUQgQlJBU1NTVEFOREFSRCBCUlVTSEVEIEJSQVNTU1RBTkRBUkQgQlVSTklTSEVEIEJSQVNTU1RBTkRBUkQgQlVSTklTSEVEIEJSQVNTU1RBTkRBUkQgUExBVEVEIEJSQVNTU1RBTkRBUkQgUExBVEVEIEJSQVNTU1RBTkRBUkQgUE9MSVNIRUQgQlJBU1NTVEFOREFSRCBQT0xJU0hFRCBCUkFTUw=="
                                            },
                                            "nullAllowed":false
                                        }
                                    }
                                ]
                            }
                        },
                        "transaction":[
                            "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                            "INSTANCE"
                        ]
                    },
                    "outputSymbols":[
                        "partkey",
                        "mfgr",
                        "type",
                        "size"
                    ],
                    "assignments":{
                        "partkey":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"partkey",
                            "type":"bigint"
                        },
                        "size":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"size",
                            "type":"integer"
                        },
                        "mfgr":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"mfgr",
                            "type":"varchar(25)"
                        },
                        "type":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"type",
                            "type":"varchar(25)"
                        }
                    },
                    "updateTarget":false,
                    "useConnectorNodePartitioning":false
                },
                "predicate":"((\"size\" = 15) AND \"@$like@52QIVVB4AK0DA1G0C96II82GDEDG0H696R5JEIK2JP1J1288Q1A14S81QG23HQJT7AE9J6EPFU6S9KBOQ8CID8KO50R4H04DMC3J4TCBEHA0FJL69B2IJLFK13DTKT14IUIUDCJG64SNLGG1E4C51K1KA0J1FKDM9010Q2I8UBK4JNDI316GMBJJR39L29BQ0K5A6RGF75L29BGBES7G26C973T3K1J4BN1OUT5MH95L7LGTBK7HBGP839JK2LQRBH3KEHHAG2JU6SNQ4SELFMQJ4NCPU4O07K970F3GQ8O4G4EGECECU3MIMU3T6JNQ3093CLLERBSSERIDHGC2PN0JJ7IO3F4E74DSVC67C29022GE9LG0====\"(\"type\", \"@$literal$@52QIVVB47G08Q1G0QA6IK8309EDG191N6P5RD51K694IEIBF98JH72BK4AOS2AF6IKMG003NFQ6SBKBOQ8CID8KO50PB000PPOFCHL19T6K117JKCT9MBGP9QNQ0HMUQEGI9F996MDO32EDQ8919282OQ0UD09GNQ6J1OVAJG0131C28254F5Q293MPHKJ8C5PPTHKQH4LT0CIT3DO7JIQHCTQMD6R2OUVO277DD4B9PCTA7QU2RN5S01QKM0E0CNBDE4EHQ8BES4JC5F0T359RVQ9ORAFATIBUGI3807K940F1GPKOEGACECU3TNMU3D6BRNPO5KGLQS0RV25PJD822HI1QI1PPK2P4U===\"(\"@from_base64@52QIVVB49009Q1G02A6II8AGDEDG1I28RCUPUK3IITKP8H4IK6S07AI33LG9UR6LI5N6CPJ6V00GRHEHC2IBEL49KQHEJP207A7JNCHDBJ97679S9OMOBO2Q9U7V5BAB9UA6MIGLRDQAI70T45GP0428A1AQ13BIH6V2A88G1M3O78KEJOBB4R9KM5QEQQAFPUIIG4HGPL18FIAH8FOKB1J4E7OI7F9P9NR9HHD37U5QL465GNPIHQ1UITTN9040DI42PC36IUJIEGPT4CUVEEAK8QQJ60GG00UH4G1SM3831Q19HPJOFOERODKLEV0CQ4D2MLLD143NUHR4C8754FP62R06TNCQFAGSAVSD\"('DgAAAFZBUklBQkxFX1dJRFRIAQAAAAEAAAALAAAAAAsAAAAGAAAAJUJSQVNTAA=='))))"
            },
            "assignments":{
                "assignments":{
                    "partkey":"\"partkey\"",
                    "mfgr":"\"mfgr\"",
                    "$hashvalue_44":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"partkey\"), 0))"
                }
            }
        },
        "symbols":{
            "type":"varchar(25)",
            "partkey":"bigint",
            "size":"integer",
            "mfgr":"varchar(25)",
            "$hashvalue_44":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "0"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "partkey",
                "mfgr",
                "$hashvalue_44"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage4 

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"4",
        "root":{
            "@type":"project",
            "id":"2744",
            "source":{
                "@type":"join",
                "id":"1695",
                "type":"INNER",
                "left":{
                    "@type":"project",
                    "id":"2741",
                    "source":{
                        "@type":"filter",
                        "id":"2135",
                        "source":{
                            "@type":"tablescan",
                            "id":"1",
                            "table":{
                                "catalogHandle":"tpch:normal:default",
                                "connectorHandle":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                    "schemaName":"sf1",
                                    "tableName":"supplier",
                                    "scaleFactor":1,
                                    "constraint":{
                                        "columnDomains":[

                                        ]
                                    }
                                },
                                "transaction":[
                                    "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                    "INSTANCE"
                                ]
                            },
                            "outputSymbols":[
                                "suppkey",
                                "name_1",
                                "address",
                                "nationkey",
                                "phone",
                                "acctbal",
                                "comment_2"
                            ],
                            "assignments":{
                                "nationkey":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"nationkey",
                                    "type":"bigint"
                                },
                                "comment_2":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"comment",
                                    "type":"varchar(101)"
                                },
                                "name_1":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"name",
                                    "type":"varchar(25)"
                                },
                                "address":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"address",
                                    "type":"varchar(40)"
                                },
                                "phone":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"phone",
                                    "type":"varchar(15)"
                                },
                                "suppkey":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"suppkey",
                                    "type":"bigint"
                                },
                                "acctbal":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"acctbal",
                                    "type":"double"
                                }
                            },
                            "updateTarget":false,
                            "useConnectorNodePartitioning":false
                        },
                        "predicate":"\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"nationkey\", 'EQUAL', 'df_2134', false)"
                    },
                    "assignments":{
                        "assignments":{
                            "suppkey":"\"suppkey\"",
                            "name_1":"\"name_1\"",
                            "address":"\"address\"",
                            "nationkey":"\"nationkey\"",
                            "phone":"\"phone\"",
                            "acctbal":"\"acctbal\"",
                            "comment_2":"\"comment_2\"",
                            "$hashvalue_48":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"nationkey\"), 0))"
                        }
                    }
                },
                "right":{
                    "@type":"exchange",
                    "id":"2460",
                    "type":"REPARTITION",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"FIXED",
                                    "function":"HASH"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[
                                {
                                    "expression":"\"nationkey_8\""
                                }
                            ]
                        },
                        "outputLayout":[
                            "nationkey_8",
                            "name_9",
                            "$hashvalue_49"
                        ],
                        "hashColumn":"$hashvalue_49",
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"1940",
                            "sourceFragmentIds":[
                                "5"
                            ],
                            "outputs":[
                                "nationkey_8",
                                "name_9",
                                "$hashvalue_50"
                            ],
                            "exchangeType":"REPLICATE",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "nationkey_8",
                            "name_9",
                            "$hashvalue_50"
                        ]
                    ]
                },
                "criteria":[
                    {
                        "left":"nationkey",
                        "right":"nationkey_8"
                    }
                ],
                "leftOutputSymbols":[
                    "suppkey",
                    "name_1",
                    "address",
                    "phone",
                    "acctbal",
                    "comment_2"
                ],
                "rightOutputSymbols":[
                    "name_9"
                ],
                "maySkipOutputDuplicates":false,
                "leftHashSymbol":"$hashvalue_48",
                "rightHashSymbol":"$hashvalue_49",
                "distributionType":"REPLICATED",
                "dynamicFilters":{
                    "df_2134":"nationkey_8"
                },
                "reorderJoinStatsAndCost":{
                    "outputRowCount":2000,
                    "outputSizeInBytes":341253.2,
                    "cpuCost":3694240.4,
                    "memoryCost":114.4,
                    "networkCost":114.4
                }
            },
            "assignments":{
                "assignments":{
                    "suppkey":"\"suppkey\"",
                    "name_1":"\"name_1\"",
                    "address":"\"address\"",
                    "phone":"\"phone\"",
                    "acctbal":"\"acctbal\"",
                    "comment_2":"\"comment_2\"",
                    "name_9":"\"name_9\"",
                    "$hashvalue_56":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"suppkey\"), 0))"
                }
            }
        },
        "symbols":{
            "nationkey":"bigint",
            "phone":"varchar(15)",
            "name_1":"varchar(25)",
            "suppkey":"bigint",
            "address":"varchar(40)",
            "nationkey_8":"bigint",
            "$hashvalue_56":"bigint",
            "$hashvalue_50":"bigint",
            "comment_2":"varchar(101)",
            "$hashvalue_49":"bigint",
            "$hashvalue_48":"bigint",
            "name_9":"varchar(25)",
            "acctbal":"double"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "1"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "suppkey",
                "name_1",
                "address",
                "phone",
                "acctbal",
                "comment_2",
                "name_9",
                "$hashvalue_56"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage5 

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"5",
        "root":{
            "@type":"project",
            "id":"2743",
            "source":{
                "@type":"join",
                "id":"1694",
                "type":"INNER",
                "left":{
                    "@type":"project",
                    "id":"2742",
                    "source":{
                        "@type":"filter",
                        "id":"2137",
                        "source":{
                            "@type":"tablescan",
                            "id":"5",
                            "table":{
                                "catalogHandle":"tpch:normal:default",
                                "connectorHandle":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                    "schemaName":"sf1",
                                    "tableName":"nation",
                                    "scaleFactor":1,
                                    "constraint":{
                                        "columnDomains":[

                                        ]
                                    }
                                },
                                "transaction":[
                                    "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                    "INSTANCE"
                                ]
                            },
                            "outputSymbols":[
                                "nationkey_8",
                                "name_9",
                                "regionkey"
                            ],
                            "assignments":{
                                "nationkey_8":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"nationkey",
                                    "type":"bigint"
                                },
                                "regionkey":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"regionkey",
                                    "type":"bigint"
                                },
                                "name_9":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"name",
                                    "type":"varchar(25)"
                                }
                            },
                            "updateTarget":false,
                            "useConnectorNodePartitioning":false
                        },
                        "predicate":"\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"regionkey\", 'EQUAL', 'df_2136', false)"
                    },
                    "assignments":{
                        "assignments":{
                            "nationkey_8":"\"nationkey_8\"",
                            "name_9":"\"name_9\"",
                            "regionkey":"\"regionkey\"",
                            "$hashvalue_51":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"regionkey\"), 0))"
                        }
                    }
                },
                "right":{
                    "@type":"exchange",
                    "id":"2459",
                    "type":"GATHER",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"SINGLE",
                                    "function":"SINGLE"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[

                            ]
                        },
                        "outputLayout":[
                            "regionkey_12",
                            "$hashvalue_52"
                        ],
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"1939",
                            "sourceFragmentIds":[
                                "6"
                            ],
                            "outputs":[
                                "regionkey_12",
                                "$hashvalue_53"
                            ],
                            "exchangeType":"REPLICATE",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "regionkey_12",
                            "$hashvalue_53"
                        ]
                    ]
                },
                "criteria":[
                    {
                        "left":"regionkey",
                        "right":"regionkey_12"
                    }
                ],
                "leftOutputSymbols":[
                    "nationkey_8",
                    "name_9"
                ],
                "rightOutputSymbols":[

                ],
                "maySkipOutputDuplicates":false,
                "leftHashSymbol":"$hashvalue_51",
                "rightHashSymbol":"$hashvalue_52",
                "distributionType":"REPLICATED",
                "dynamicFilters":{
                    "df_2136":"regionkey_12"
                },
                "reorderJoinStatsAndCost":{
                    "outputRowCount":5,
                    "outputSizeInBytes":105.4,
                    "cpuCost":1844.4,
                    "memoryCost":9,
                    "networkCost":9
                }
            },
            "assignments":{
                "assignments":{
                    "nationkey_8":"\"nationkey_8\"",
                    "name_9":"\"name_9\"",
                    "$hashvalue_55":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"nationkey_8\"), 0))"
                }
            }
        },
        "symbols":{
            "regionkey_12":"bigint",
            "nationkey_8":"bigint",
            "regionkey":"bigint",
            "$hashvalue_55":"bigint",
            "$hashvalue_52":"bigint",
            "$hashvalue_51":"bigint",
            "$hashvalue_53":"bigint",
            "name_9":"varchar(25)"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "5"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "nationkey_8",
                "name_9",
                "$hashvalue_55"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage6

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"6",
        "root":{
            "@type":"project",
            "id":"1191",
            "source":{
                "@type":"filter",
                "id":"595",
                "source":{
                    "@type":"tablescan",
                    "id":"7",
                    "table":{
                        "catalogHandle":"tpch:normal:default",
                        "connectorHandle":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                            "schemaName":"sf1",
                            "tableName":"region",
                            "scaleFactor":1,
                            "constraint":{
                                "columnDomains":[

                                ]
                            }
                        },
                        "transaction":[
                            "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                            "INSTANCE"
                        ]
                    },
                    "outputSymbols":[
                        "regionkey_12",
                        "name_13"
                    ],
                    "assignments":{
                        "name_13":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"name",
                            "type":"varchar(25)"
                        },
                        "regionkey_12":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"regionkey",
                            "type":"bigint"
                        }
                    },
                    "updateTarget":false,
                    "useConnectorNodePartitioning":false
                },
                "predicate":"(\"name_13\" = CAST('EUROPE' AS varchar(25)))"
            },
            "assignments":{
                "assignments":{
                    "regionkey_12":"\"regionkey_12\"",
                    "$hashvalue_54":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"regionkey_12\"), 0))"
                }
            }
        },
        "symbols":{
            "regionkey_12":"bigint",
            "$hashvalue_54":"bigint",
            "name_13":"varchar(25)"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "7"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "regionkey_12",
                "$hashvalue_54"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage7

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"7",
        "root":{
            "@type":"project",
            "id":"2752",
            "source":{
                "@type":"aggregation",
                "id":"20",
                "source":{
                    "@type":"exchange",
                    "id":"2603",
                    "type":"REPARTITION",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"FIXED",
                                    "function":"HASH"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[
                                {
                                    "expression":"\"partkey_16\""
                                }
                            ]
                        },
                        "outputLayout":[
                            "partkey_16",
                            "min_41",
                            "$hashvalue_60"
                        ],
                        "hashColumn":"$hashvalue_60",
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"2609",
                            "sourceFragmentIds":[
                                "8"
                            ],
                            "outputs":[
                                "partkey_16",
                                "min_41",
                                "$hashvalue_61"
                            ],
                            "exchangeType":"REPARTITION",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "partkey_16",
                            "min_41",
                            "$hashvalue_61"
                        ]
                    ]
                },
                "aggregations":{
                    "min":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"min",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"min<t:orderable>(t):t",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{
                                "double":"double"
                            },
                            "functionDependencies":[
                                {
                                    "signature":{
                                        "name":"$operator$COMPARISON_UNORDERED_LAST",
                                        "returnType":"integer",
                                        "argumentTypes":[
                                            "double",
                                            "double"
                                        ]
                                    },
                                    "catalogHandle":"system:normal:system",
                                    "id":"$operator$comparison_unordered_last<t:orderable>(t,t):integer",
                                    "functionKind":"SCALAR",
                                    "deterministic":true,
                                    "nullability":{
                                        "returnNullable":false,
                                        "argumentNullable":[
                                            false,
                                            false
                                        ]
                                    },
                                    "typeDependencies":{

                                    },
                                    "functionDependencies":[

                                    ]
                                }
                            ]
                        },
                        "arguments":[
                            "\"min_41\""
                        ],
                        "distinct":false
                    }
                },
                "groupingSets":{
                    "groupingKeys":[
                        "partkey_16"
                    ],
                    "groupingSetCount":1,
                    "globalGroupingSets":[

                    ]
                },
                "preGroupedSymbols":[

                ],
                "step":"FINAL"
            },
            "assignments":{
                "assignments":{
                    "partkey_16":"\"partkey_16\"",
                    "min":"\"min\"",
                    "$hashvalue_75":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"partkey_16\"), 0))"
                }
            }
        },
        "symbols":{
            "min":"double",
            "$hashvalue_75":"bigint",
            "min_41":"double",
            "$hashvalue_61":"bigint",
            "$hashvalue_60":"bigint",
            "partkey_16":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"FIXED",
                "function":"HASH"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "partkey_16",
                "min",
                "$hashvalue_75"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage8

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"8",
        "root":{
            "@type":"project",
            "id":"2751",
            "source":{
                "@type":"aggregation",
                "id":"2607",
                "source":{
                    "@type":"project",
                    "id":"613",
                    "source":{
                        "@type":"join",
                        "id":"1726",
                        "type":"INNER",
                        "left":{
                            "@type":"project",
                            "id":"2746",
                            "source":{
                                "@type":"filter",
                                "id":"2149",
                                "source":{
                                    "@type":"tablescan",
                                    "id":"9",
                                    "table":{
                                        "catalogHandle":"tpch:normal:default",
                                        "connectorHandle":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                            "schemaName":"sf1",
                                            "tableName":"partsupp",
                                            "scaleFactor":1,
                                            "constraint":{
                                                "columnDomains":[

                                                ]
                                            }
                                        },
                                        "transaction":[
                                            "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                            "INSTANCE"
                                        ]
                                    },
                                    "outputSymbols":[
                                        "partkey_16",
                                        "suppkey_17",
                                        "supplycost_19"
                                    ],
                                    "assignments":{
                                        "suppkey_17":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                            "columnName":"suppkey",
                                            "type":"bigint"
                                        },
                                        "supplycost_19":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                            "columnName":"supplycost",
                                            "type":"double"
                                        },
                                        "partkey_16":{
                                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                            "columnName":"partkey",
                                            "type":"bigint"
                                        }
                                    },
                                    "updateTarget":false,
                                    "useConnectorNodePartitioning":false
                                },
                                "predicate":"\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"suppkey_17\", 'EQUAL', 'df_2148', false)"
                            },
                            "assignments":{
                                "assignments":{
                                    "partkey_16":"\"partkey_16\"",
                                    "suppkey_17":"\"suppkey_17\"",
                                    "supplycost_19":"\"supplycost_19\"",
                                    "$hashvalue_62":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"suppkey_17\"), 0))"
                                }
                            }
                        },
                        "right":{
                            "@type":"exchange",
                            "id":"2464",
                            "type":"REPARTITION",
                            "scope":"LOCAL",
                            "partitioningScheme":{
                                "partitioning":{
                                    "handle":{
                                        "connectorHandle":{
                                            "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                            "partitioning":"FIXED",
                                            "function":"HASH"
                                        },
                                        "scaleWriters":false
                                    },
                                    "arguments":[
                                        {
                                            "expression":"\"suppkey_22\""
                                        }
                                    ]
                                },
                                "outputLayout":[
                                    "suppkey_22",
                                    "$hashvalue_63"
                                ],
                                "hashColumn":"$hashvalue_63",
                                "replicateNullsAndAny":false
                            },
                            "sources":[
                                {
                                    "@type":"remoteSource",
                                    "id":"1944",
                                    "sourceFragmentIds":[
                                        "9"
                                    ],
                                    "outputs":[
                                        "suppkey_22",
                                        "$hashvalue_64"
                                    ],
                                    "exchangeType":"REPLICATE",
                                    "retryPolicy":"NONE"
                                }
                            ],
                            "inputs":[
                                [
                                    "suppkey_22",
                                    "$hashvalue_64"
                                ]
                            ]
                        },
                        "criteria":[
                            {
                                "left":"suppkey_17",
                                "right":"suppkey_22"
                            }
                        ],
                        "leftOutputSymbols":[
                            "partkey_16",
                            "supplycost_19"
                        ],
                        "rightOutputSymbols":[

                        ],
                        "maySkipOutputDuplicates":false,
                        "leftHashSymbol":"$hashvalue_62",
                        "rightHashSymbol":"$hashvalue_63",
                        "distributionType":"REPLICATED",
                        "dynamicFilters":{
                            "df_2148":"suppkey_22"
                        },
                        "reorderJoinStatsAndCost":{
                            "outputRowCount":160000,
                            "outputSizeInBytes":2880000,
                            "cpuCost":46495270,
                            "memoryCost":18045,
                            "networkCost":18054
                        }
                    },
                    "assignments":{
                        "assignments":{
                            "non_null":"true",
                            "supplycost_19":"\"supplycost_19\"",
                            "partkey_16":"\"partkey_16\""
                        }
                    }
                },
                "aggregations":{
                    "min_41":{
                        "resolvedFunction":{
                            "signature":{
                                "name":"min",
                                "returnType":"double",
                                "argumentTypes":[
                                    "double"
                                ]
                            },
                            "catalogHandle":"system:normal:system",
                            "id":"min<t:orderable>(t):t",
                            "functionKind":"AGGREGATE",
                            "deterministic":true,
                            "nullability":{
                                "returnNullable":true,
                                "argumentNullable":[
                                    false
                                ]
                            },
                            "typeDependencies":{
                                "double":"double"
                            },
                            "functionDependencies":[
                                {
                                    "signature":{
                                        "name":"$operator$COMPARISON_UNORDERED_LAST",
                                        "returnType":"integer",
                                        "argumentTypes":[
                                            "double",
                                            "double"
                                        ]
                                    },
                                    "catalogHandle":"system:normal:system",
                                    "id":"$operator$comparison_unordered_last<t:orderable>(t,t):integer",
                                    "functionKind":"SCALAR",
                                    "deterministic":true,
                                    "nullability":{
                                        "returnNullable":false,
                                        "argumentNullable":[
                                            false,
                                            false
                                        ]
                                    },
                                    "typeDependencies":{

                                    },
                                    "functionDependencies":[

                                    ]
                                }
                            ]
                        },
                        "arguments":[
                            "\"supplycost_19\""
                        ],
                        "distinct":false,
                        "mask":"non_null"
                    }
                },
                "groupingSets":{
                    "groupingKeys":[
                        "partkey_16"
                    ],
                    "groupingSetCount":1,
                    "globalGroupingSets":[

                    ]
                },
                "preGroupedSymbols":[

                ],
                "step":"PARTIAL"
            },
            "assignments":{
                "assignments":{
                    "partkey_16":"\"partkey_16\"",
                    "min_41":"\"min_41\"",
                    "$hashvalue_74":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"partkey_16\"), 0))"
                }
            }
        },
        "symbols":{
            "non_null":"boolean",
            "$hashvalue_74":"bigint",
            "suppkey_22":"bigint",
            "min_41":"double",
            "$hashvalue_63":"bigint",
            "$hashvalue_62":"bigint",
            "$hashvalue_64":"bigint",
            "suppkey_17":"bigint",
            "supplycost_19":"double",
            "partkey_16":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "9"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"HASH"
                    },
                    "scaleWriters":false
                },
                "arguments":[
                    {
                        "expression":"\"partkey_16\""
                    }
                ]
            },
            "outputLayout":[
                "partkey_16",
                "min_41",
                "$hashvalue_74"
            ],
            "hashColumn":"$hashvalue_74",
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage9

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"9",
        "root":{
            "@type":"project",
            "id":"2750",
            "source":{
                "@type":"join",
                "id":"1723",
                "type":"INNER",
                "left":{
                    "@type":"project",
                    "id":"2747",
                    "source":{
                        "@type":"filter",
                        "id":"2151",
                        "source":{
                            "@type":"tablescan",
                            "id":"10",
                            "table":{
                                "catalogHandle":"tpch:normal:default",
                                "connectorHandle":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                    "schemaName":"sf1",
                                    "tableName":"supplier",
                                    "scaleFactor":1,
                                    "constraint":{
                                        "columnDomains":[

                                        ]
                                    }
                                },
                                "transaction":[
                                    "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                    "INSTANCE"
                                ]
                            },
                            "outputSymbols":[
                                "suppkey_22",
                                "nationkey_25"
                            ],
                            "assignments":{
                                "suppkey_22":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"suppkey",
                                    "type":"bigint"
                                },
                                "nationkey_25":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"nationkey",
                                    "type":"bigint"
                                }
                            },
                            "updateTarget":false,
                            "useConnectorNodePartitioning":false
                        },
                        "predicate":"\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"nationkey_25\", 'EQUAL', 'df_2150', false)"
                    },
                    "assignments":{
                        "assignments":{
                            "suppkey_22":"\"suppkey_22\"",
                            "nationkey_25":"\"nationkey_25\"",
                            "$hashvalue_65":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"nationkey_25\"), 0))"
                        }
                    }
                },
                "right":{
                    "@type":"exchange",
                    "id":"2463",
                    "type":"REPARTITION",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"FIXED",
                                    "function":"HASH"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[
                                {
                                    "expression":"\"nationkey_30\""
                                }
                            ]
                        },
                        "outputLayout":[
                            "nationkey_30",
                            "$hashvalue_66"
                        ],
                        "hashColumn":"$hashvalue_66",
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"1943",
                            "sourceFragmentIds":[
                                "10"
                            ],
                            "outputs":[
                                "nationkey_30",
                                "$hashvalue_67"
                            ],
                            "exchangeType":"REPLICATE",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "nationkey_30",
                            "$hashvalue_67"
                        ]
                    ]
                },
                "criteria":[
                    {
                        "left":"nationkey_25",
                        "right":"nationkey_30"
                    }
                ],
                "leftOutputSymbols":[
                    "suppkey_22"
                ],
                "rightOutputSymbols":[

                ],
                "maySkipOutputDuplicates":false,
                "leftHashSymbol":"$hashvalue_65",
                "rightHashSymbol":"$hashvalue_66",
                "distributionType":"REPLICATED",
                "dynamicFilters":{
                    "df_2150":"nationkey_30"
                },
                "reorderJoinStatsAndCost":{
                    "outputRowCount":2000,
                    "outputSizeInBytes":18000,
                    "cpuCost":379270,
                    "memoryCost":54,
                    "networkCost":54
                }
            },
            "assignments":{
                "assignments":{
                    "suppkey_22":"\"suppkey_22\"",
                    "$hashvalue_73":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"suppkey_22\"), 0))"
                }
            }
        },
        "symbols":{
            "nationkey_30":"bigint",
            "$hashvalue_73":"bigint",
            "suppkey_22":"bigint",
            "nationkey_25":"bigint",
            "$hashvalue_67":"bigint",
            "$hashvalue_66":"bigint",
            "$hashvalue_65":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "10"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "suppkey_22",
                "$hashvalue_73"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage10

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"10",
        "root":{
            "@type":"project",
            "id":"2749",
            "source":{
                "@type":"join",
                "id":"1722",
                "type":"INNER",
                "left":{
                    "@type":"project",
                    "id":"2748",
                    "source":{
                        "@type":"filter",
                        "id":"2153",
                        "source":{
                            "@type":"tablescan",
                            "id":"12",
                            "table":{
                                "catalogHandle":"tpch:normal:default",
                                "connectorHandle":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                                    "schemaName":"sf1",
                                    "tableName":"nation",
                                    "scaleFactor":1,
                                    "constraint":{
                                        "columnDomains":[

                                        ]
                                    }
                                },
                                "transaction":[
                                    "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                                    "INSTANCE"
                                ]
                            },
                            "outputSymbols":[
                                "nationkey_30",
                                "regionkey_32"
                            ],
                            "assignments":{
                                "regionkey_32":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"regionkey",
                                    "type":"bigint"
                                },
                                "nationkey_30":{
                                    "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                                    "columnName":"nationkey",
                                    "type":"bigint"
                                }
                            },
                            "updateTarget":false,
                            "useConnectorNodePartitioning":false
                        },
                        "predicate":"\"@$internal$dynamic_filter_function@52QIVVB4M407Q1O0A872O82G9FDG1BC454KTNSH7MKMOR908MU5RT08VSO8OSUIV40D36CT1VU7S4U4SGH75FC92LI614A6JMIGMSPCIA0BK5KTRUR4BA7H3QBBJL8EQER5SN6LM4A4308BHI0C51O1L82A00K130GT00MA4J1BB5DJGCBDASSCOA0BS4MD05GLJM5D28V8P4GDLDH089JDBTI0KCGMNLJM2IBAJQUP1OJ5JO3MRADI4P35RDOKN5IDFDMJ4K6B2ADU8C4IJEREU0CJ595KC9P16RBSJILQUG10N00UH5K1SM3FB141IK4JJT7GT1JK1SJHR0F19065IOAGNBL97DK7T4SM8MOLC33LC4GCQ458JVTB09M3IHHJN17AH0C6P868RQULEC===\"(\"regionkey_32\", 'EQUAL', 'df_2152', false)"
                    },
                    "assignments":{
                        "assignments":{
                            "nationkey_30":"\"nationkey_30\"",
                            "regionkey_32":"\"regionkey_32\"",
                            "$hashvalue_68":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"regionkey_32\"), 0))"
                        }
                    }
                },
                "right":{
                    "@type":"exchange",
                    "id":"2462",
                    "type":"GATHER",
                    "scope":"LOCAL",
                    "partitioningScheme":{
                        "partitioning":{
                            "handle":{
                                "connectorHandle":{
                                    "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                                    "partitioning":"SINGLE",
                                    "function":"SINGLE"
                                },
                                "scaleWriters":false
                            },
                            "arguments":[

                            ]
                        },
                        "outputLayout":[
                            "regionkey_35",
                            "$hashvalue_69"
                        ],
                        "replicateNullsAndAny":false
                    },
                    "sources":[
                        {
                            "@type":"remoteSource",
                            "id":"1942",
                            "sourceFragmentIds":[
                                "11"
                            ],
                            "outputs":[
                                "regionkey_35",
                                "$hashvalue_70"
                            ],
                            "exchangeType":"REPLICATE",
                            "retryPolicy":"NONE"
                        }
                    ],
                    "inputs":[
                        [
                            "regionkey_35",
                            "$hashvalue_70"
                        ]
                    ]
                },
                "criteria":[
                    {
                        "left":"regionkey_32",
                        "right":"regionkey_35"
                    }
                ],
                "leftOutputSymbols":[
                    "nationkey_30"
                ],
                "rightOutputSymbols":[

                ],
                "maySkipOutputDuplicates":false,
                "leftHashSymbol":"$hashvalue_68",
                "rightHashSymbol":"$hashvalue_69",
                "distributionType":"REPLICATED",
                "dynamicFilters":{
                    "df_2152":"regionkey_35"
                },
                "reorderJoinStatsAndCost":{
                    "outputRowCount":5,
                    "outputSizeInBytes":45,
                    "cpuCost":1180,
                    "memoryCost":9,
                    "networkCost":9
                }
            },
            "assignments":{
                "assignments":{
                    "nationkey_30":"\"nationkey_30\"",
                    "$hashvalue_72":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"nationkey_30\"), 0))"
                }
            }
        },
        "symbols":{
            "nationkey_30":"bigint",
            "$hashvalue_70":"bigint",
            "$hashvalue_72":"bigint",
            "$hashvalue_69":"bigint",
            "$hashvalue_68":"bigint",
            "regionkey_32":"bigint",
            "regionkey_35":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "12"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "nationkey_30",
                "$hashvalue_72"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage11

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"11",
        "root":{
            "@type":"project",
            "id":"757",
            "source":{
                "@type":"filter",
                "id":"609",
                "source":{
                    "@type":"tablescan",
                    "id":"14",
                    "table":{
                        "catalogHandle":"tpch:normal:default",
                        "connectorHandle":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchTableHandle",
                            "schemaName":"sf1",
                            "tableName":"region",
                            "scaleFactor":1,
                            "constraint":{
                                "columnDomains":[

                                ]
                            }
                        },
                        "transaction":[
                            "tpch:io.trino.plugin.tpch.TpchTransactionHandle",
                            "INSTANCE"
                        ]
                    },
                    "outputSymbols":[
                        "regionkey_35",
                        "name_36"
                    ],
                    "assignments":{
                        "regionkey_35":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"regionkey",
                            "type":"bigint"
                        },
                        "name_36":{
                            "@type":"tpch:io.trino.plugin.tpch.TpchColumnHandle",
                            "columnName":"name",
                            "type":"varchar(25)"
                        }
                    },
                    "updateTarget":false,
                    "useConnectorNodePartitioning":false
                },
                "predicate":"(\"name_36\" = CAST('EUROPE' AS varchar(25)))"
            },
            "assignments":{
                "assignments":{
                    "regionkey_35":"\"regionkey_35\"",
                    "$hashvalue_71":"\"@combine_hash@52QIVVB4AK07Q1G0M962E7RG96DG116UCQKPD4HHQ89CM9K1TID9G8454JD9F7HN31A3BG0VHE1R2Q7E1G9L2J0K2KS802J61LI0I8FEJ079KETJJ7P40A9LVN0RDTKESIPD8L0B2U9PU8OO1G6042CQ0MTE88MQ20BN004IVJSIB96MKAJN06E3FR3P8A12A2B885H17U5O6SB7LEK9LCMGPTBL7IF3ETA302LQRBHFKUC2K7204QGUD90NSHS5UJ6HQLQRKH5B4DO12803Q4JG7HOD4C282787676F1R6BF1UJ5QBSVIUL6NPQ16RAP08S7JA3QU53JNL81HT2S3BB9KPG9NPLLK======\"(bigint '0', COALESCE(\"@$operator$HASH_CODE@52QIVVB4AO0EA1G0C872O7R0D7DMQ869JQMSOJ7D9SHGIKB7RAQLKFV26CEGOES2M61I13351L2T4U1K3LRN4NKS3D371ORSO972QGSJQM0V7BAQB6IPS9V2QTF37TDRUPF8R7SN8ICN060SGU27F0DJVRI8V8811SOC0IMPMR6M4IAVG0BPC5GBDOBPCJKKL9R3BPLQV2EU6KKJQNH8MC2CTLNKLL2G4IDET7ENCFD2DINNCPD4IJBE3G2MVRTP4L504162C60I83M4Q3C6VOS635997LRQ7QDDPNLF6FMV428F00UH4G1S639J1Q19HPJGFPMRODKREV0C86DHA87C7I7G5NV17J2HP917KMPC2F03MIG3130=\"(\"regionkey_35\"), 0))"
                }
            }
        },
        "symbols":{
            "name_36":"varchar(25)",
            "$hashvalue_71":"bigint",
            "regionkey_35":"bigint"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SOURCE",
                "function":"UNKNOWN"
            },
            "scaleWriters":false
        },
        "partitionedSources":[
            "14"
        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "regionkey_35",
                "$hashvalue_71"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[1],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

### Stage12

```json
{
    "session":Object{...},
    "extraCredentials":Object{...},
    "fragment":{
        "id":"12",
        "root":{
            "@type":"aggregation",
            "id":"995",
            "source":{
                "@type":"values",
                "id":"994",
                "outputSymbols":[
                    "null",
                    "null_38"
                ],
                "rowCount":1,
                "rows":[
                    "ROW (CAST(null AS boolean), CAST(null AS double))"
                ]
            },
            "aggregations":{
                "min_40":{
                    "resolvedFunction":{
                        "signature":{
                            "name":"min",
                            "returnType":"double",
                            "argumentTypes":[
                                "double"
                            ]
                        },
                        "catalogHandle":"system:normal:system",
                        "id":"min<t:orderable>(t):t",
                        "functionKind":"AGGREGATE",
                        "deterministic":true,
                        "nullability":{
                            "returnNullable":true,
                            "argumentNullable":[
                                false
                            ]
                        },
                        "typeDependencies":{
                            "double":"double"
                        },
                        "functionDependencies":[
                            {
                                "signature":{
                                    "name":"$operator$COMPARISON_UNORDERED_LAST",
                                    "returnType":"integer",
                                    "argumentTypes":[
                                        "double",
                                        "double"
                                    ]
                                },
                                "catalogHandle":"system:normal:system",
                                "id":"$operator$comparison_unordered_last<t:orderable>(t,t):integer",
                                "functionKind":"SCALAR",
                                "deterministic":true,
                                "nullability":{
                                    "returnNullable":false,
                                    "argumentNullable":[
                                        false,
                                        false
                                    ]
                                },
                                "typeDependencies":{

                                },
                                "functionDependencies":[

                                ]
                            }
                        ]
                    },
                    "arguments":[
                        "\"null_38\""
                    ],
                    "distinct":false,
                    "mask":"null"
                }
            },
            "groupingSets":{
                "groupingKeys":[

                ],
                "groupingSetCount":1,
                "globalGroupingSets":[
                    0
                ]
            },
            "preGroupedSymbols":[

            ],
            "step":"SINGLE"
        },
        "symbols":{
            "min_40":"double",
            "null_38":"double",
            "null":"boolean"
        },
        "partitioning":{
            "connectorHandle":{
                "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                "partitioning":"SINGLE",
                "function":"SINGLE"
            },
            "scaleWriters":false
        },
        "partitionedSources":[

        ],
        "partitioningScheme":{
            "partitioning":{
                "handle":{
                    "connectorHandle":{
                        "@type":"system:io.trino.sql.planner.SystemPartitioningHandle",
                        "partitioning":"FIXED",
                        "function":"BROADCAST"
                    },
                    "scaleWriters":false
                },
                "arguments":[

                ]
            },
            "outputLayout":[
                "min_40"
            ],
            "replicateNullsAndAny":false,
            "bucketToPartition":[
                0
            ]
        },
        "statsAndCosts":{
            "stats":{

            },
            "costs":{

            }
        },
        "activeCatalogs":[

        ]
    },
    "splitAssignments":Array[0],
    "outputIds":Object{...},
    "dynamicFilterDomains":{

    }
}
```

